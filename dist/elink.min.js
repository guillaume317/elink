/**
 * elink - v0.1.0-0 - 2015-12-22
 *
 * Copyright (c) 2015 ICDC
 */
angular.module("el1.accueil",["ngMaterial","ui.router","el1.services.commun","el1.model"]).config(function($stateProvider){$stateProvider.state("home",{url:"/home",data:{pageTitle:"Home"},views:{main:{controller:"toolbarController",templateUrl:"src/app/accueil/accueil.tpl.html"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function($translate,$translatePartialLoader){$translatePartialLoader.addPart("commons")}],currentAuth:["FBFactory",function(FBFactory){return FBFactory.auth().$requireAuth()}]}})}),function(){function ToolbarController($log,$scope,$rootScope,$state,AuthService,$mdDialog,$mdMedia){$scope.selectedIndex=0,$scope.isAdmin=!0,$scope.$watch("selectedIndex",function(current,old){switch(current){case 0:$state.go("bibli-nonLu");break;case 1:$state.go("bibli-lu");break;case 2:$state.go("cercle-view");break;case 3:$state.go("icdc-view")}}),$scope.admin=function(){$state.go("gestion-view")},$scope.nouveauLien=function(ev){$mdDialog.show({controller:NouveauLienController,templateUrl:"src/app/accueil/views/el1-nouveauLien.tpl.html",parent:angular.element(document.body),targetEvent:ev,locals:{},clickOutsideToClose:!0,fullscreen:$mdMedia("sm")&&$scope.customFullscreen}).then(function(shareLink){},function(){}),$scope.$watch(function(){return $mdMedia("sm")},function(sm){$scope.customFullscreen=sm===!0})},$scope.logout=function(){AuthService.logout(),$state.go("showLogin"),$rootScope.userAuthenticated=!1}}function NouveauLienController($log,$scope,$rootScope,LiensService,SessionStorage,USERFIREBASEPROFILEKEY,$mdDialog,$mdMedia){$scope.currentLien={url:"http://","private":"nonlu"},$scope.alerts=[],$scope.hide=function(){$mdDialog.hide()},$scope.cancel=function(){$mdDialog.cancel()},$scope.validate=function(){$scope.currentForm.$valid&&LiensService.createLinkForUser($scope.currentLien,SessionStorage.get(USERFIREBASEPROFILEKEY).uid).then(function(newLink){LiensService.screenshotAndStore(newLink).then(function(linkScreen){var anId=newLink.$id;$rootScope.images[anId]=linkScreen},function(error){$log.error(error)}),$mdDialog.hide(newLink)},function(error){$log.error(error)})},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)}}angular.module("el1.accueil").controller("toolbarController",["$log","$scope","$rootScope","$state","AuthService","$mdDialog","$mdMedia",ToolbarController]).controller("nouveauLienController",["$log","$scope","$rootScope","LiensService","SessionStorage","USERFIREBASEPROFILEKEY","$mdDialog","$mdMedia",NouveauLienController])}(),angular.module("el1.model",[]),angular.module("el1.services.commun",["el1.model"]),angular.module("elinkApp",["ngCookies","ngMessages","ngMaterial","ngMdIcons","ui.router.state","ui.router","pascalprecht.translate","firebase","el1.model","el1.services.commun","el1.accueil","el1.icdc","el1.bibli","el1.login","el1.cercle","el1.gestion","el1.error"]).run(function($rootScope,$location,$window,$http,$state,$translate,Env,AuthService,UserModel,$cookieStore,UsersManager){if($rootScope.images=[],$rootScope.userAuthenticated=!1,$rootScope.$on("$stateChangeError",function(event,toState,toParams,fromState,fromParams,error){"AUTH_REQUIRED"===error&&$state.go("showLogin")}),$rootScope.$on("$stateChangeStart",function(event,toState,toStateParams){$rootScope.toState=toState,$rootScope.toStateParams=toStateParams}),$rootScope.$on("$stateChangeSuccess",function(event,toState,toParams,fromState,fromParams){var titleKey="global.title";$rootScope.previousStateName=fromState.name,$rootScope.previousStateParams=fromParams,toState.data.pageTitle&&(titleKey=toState.data.pageTitle),$translate(titleKey).then(function(title){$window.document.title=title})}),$rootScope.back=function(){"activate"===$rootScope.previousStateName||null===$state.get($rootScope.previousStateName)?$state.go("home"):$state.go($rootScope.previousStateName,$rootScope.previousStateParams)},$http.get("appconf/environment.json").then(function(response){Env.init(response.data)}),Env.isMock()){var mockUser=new UserModel;$rootScope.user=mockUser,Env.setUser(mockUser)}else $rootScope.user=$cookieStore.get("user"),$rootScope.user&&($rootScope.userAuthenticated=!0,Env.setUser($rootScope.user))}).constant("RESTBACKEND","http://localhost:8080/banconet/api/v1").constant("FBURL","https://elink.firebaseio.com/").constant("GOOGLEAUTHSCOPE","email, profile").constant("USERFIREBASEPROFILEKEY","firebase:session::elink").config(function($stateProvider,$urlRouterProvider,$httpProvider,$translateProvider,$mdThemingProvider,$mdDateLocaleProvider){$urlRouterProvider.otherwise("/showLogin"),$httpProvider.interceptors.push("errorHandlerInterceptor"),$translateProvider.useLoader("$translatePartialLoader",{urlTemplate:"src/i18n/{lang}/{part}.json"}),$translateProvider.preferredLanguage("fr"),$translateProvider.useCookieStorage(),$translateProvider.useSanitizeValueStrategy("escaped"),$translateProvider.addInterpolation("$translateMessageFormatInterpolation");var neonRedMap=$mdThemingProvider.extendPalette("red",{500:"b71c1c"});$mdThemingProvider.definePalette("neonRed",neonRedMap),$mdThemingProvider.theme("default").primaryPalette("neonRed"),$mdDateLocaleProvider.parseDate=function(dateString){var m=new Date(dateString);return"Invalid Date"==m?m:Date.now()},$mdDateLocaleProvider.formatDate=function(date){if(!date)return"";if("Invalid Date"==date)return"Date non valide";var m=new Date(date);return m.formatDate("dd/MM/yyyy")}}),function(module){"use strict";module.config(function($stateProvider){$stateProvider.state("bibli-nonLu",{url:"/bibli/nonLu",data:{title:"view"},views:{main:{controller:"bibliController",templateUrl:"src/app/bibli/views/el1-nonLu.tpl.html",resolve:{liensNonLus:["$rootScope","LiensService","SessionStorage","USERFIREBASEPROFILEKEY",function($rootScope,LiensService,SessionStorage,USERFIREBASEPROFILEKEY){return LiensService.findNotReadLinksByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],liensLus:["$rootScope","LiensService","SessionStorage","USERFIREBASEPROFILEKEY",function($rootScope,LiensService,SessionStorage,USERFIREBASEPROFILEKEY){return LiensService.findReadLinksByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],allMyCercles:["$rootScope","UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",function($rootScope,UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){return UsersManager.findCerclesByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],allCategories:["LiensService",function(LiensService){return LiensService.findCategories()}]}}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function($translate,$translatePartialLoader){return $translatePartialLoader.addPart("commons"),$translatePartialLoader.addPart("el1-view"),$translate.refresh()}],currentAuth:["FBFactory",function(FBFactory){return FBFactory.auth().$requireAuth()}]}}),$stateProvider.state("bibli-lu",{url:"/bibli/lu",data:{title:"view"},views:{main:{controller:"bibliController",templateUrl:"src/app/bibli/views/el1-lu.tpl.html",resolve:{liensNonLus:["$rootScope","LiensService","SessionStorage","USERFIREBASEPROFILEKEY",function($rootScope,LiensService,SessionStorage,USERFIREBASEPROFILEKEY){return LiensService.findNotReadLinksByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],liensLus:["$rootScope","LiensService","SessionStorage","USERFIREBASEPROFILEKEY",function($rootScope,LiensService,SessionStorage,USERFIREBASEPROFILEKEY){return LiensService.findReadLinksByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],allMyCercles:["$rootScope","UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",function($rootScope,UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){return UsersManager.findCerclesByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],allCategories:["LiensService",function(LiensService){return LiensService.findCategories()}]}}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function($translate,$translatePartialLoader){return $translatePartialLoader.addPart("commons"),$translatePartialLoader.addPart("el1-view"),$translate.refresh()}],currentAuth:["FBFactory",function(FBFactory){return FBFactory.auth().$requireAuth()}]}})})}(angular.module("el1.bibli",["ngMaterial","ui.router","el1.services.commun","el1.model"])),function(){function BibliController($log,$scope,$state,commonsService,liensNonLus,liensLus,allMyCercles,allCategories,$mdDialog,$mdMedia,$mdToast){$scope.customFullscreen=$mdMedia("sm"),"bibli-nonLu"===$state.current.name?$scope.liens=liensNonLus:$scope.liens=liensLus,$scope.showURL=function(lien){window.open(lien.url,"_blank")},$scope.canShare=function(){return allMyCercles&&allMyCercles[0]},$scope.deleteLink=function(lien){$scope.liens.$remove(lien),commonsService.showSuccessToast($mdToast,"Le lien a été supprimé")},$scope.moveTo=function(lien){lien.keyOri||(lien.keyOri=lien.$id),"bibli-nonLu"===$state.current.name?liensLus.$add(lien):liensNonLus.$add(lien),$scope.deleteLink(lien),commonsService.showSuccessToast($mdToast,"Le lien a été déplacé")},$scope.share=function(ev,lien){$mdDialog.show({controller:ShareController,templateUrl:"src/app/bibli/views/el1-share.tpl.html",parent:angular.element(document.body),targetEvent:ev,locals:{linkToShare:lien,allCategories:allCategories,allMyCercles:allMyCercles,listeLiens:$scope.liens},clickOutsideToClose:!0,fullscreen:$mdMedia("sm")&&$scope.customFullscreen}).then(function(shareLink){commonsService.showSuccessToast($mdToast,"Le lien a bien été partagé avec le cercle "+shareLink.cercleName)},function(){}),$scope.$watch(function(){return $mdMedia("sm")},function(sm){$scope.customFullscreen=sm===!0})}}function ShareController($log,$scope,$cookieStore,GestionService,linkToShare,allCategories,allMyCercles,listeLiens,SessionStorage,USERFIREBASEPROFILEKEY,$mdDialog,$mdMedia){$scope.categories=allCategories,$scope.cercles=allMyCercles,$scope.linkToShare=linkToShare;var keyOri;keyOri=linkToShare.keyOri?linkToShare.keyOri:linkToShare.$id;var cercleName=allMyCercles[0].$id,category=allCategories[0];$cookieStore.get("selectedCategory")&&(category=$cookieStore.get("selectedCategory")),$cookieStore.get("selectedCercle")&&(cercleName=$cookieStore.get("selectedCercle").$id),$scope.shareLink={title:linkToShare.title,teasing:linkToShare.teasing,createdOn:linkToShare.createdOn,url:linkToShare.url,cercleName:cercleName,category:category,keyOri:keyOri},$scope.hide=function(){$mdDialog.hide()},$scope.cancel=function(){$mdDialog.cancel()},$scope.validate=function(shareLink){$scope.currentForm.$valid&&GestionService.shareLien(shareLink,SessionStorage.get(USERFIREBASEPROFILEKEY)).then(function(){listeLiens.$remove(linkToShare),$mdDialog.hide(shareLink)})["catch"](function(error){$log.error(error)})}}angular.module("el1.bibli").controller("bibliController",["$log","$scope","$state","commonsService","liensNonLus","liensLus","allMyCercles","allCategories","$mdDialog","$mdMedia","$mdToast",BibliController]).controller("shareController",["$log","$scope","$cookieStore","GestionService","linkToShare","allCategories","allMyCercles","listeLiens","SessionStorage","USERFIREBASEPROFILEKEY","$mdDialog","$mdMedia",ShareController])}(),function(module){"use strict";module.config(function($stateProvider){$stateProvider.state("cercle-view",{url:"/cercle/view",data:{title:"view"},views:{main:{controller:"cercleController",templateUrl:"src/app/cercle/views/el1-view.tpl.html",resolve:{liens:["$log","$cookieStore","LiensService","UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",function($log,$cookieStore,LiensService,UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){if($cookieStore.get("selectedCercle")){var cercleName=$cookieStore.get("selectedCercle");return LiensService.findLinksByCerlceName(cercleName.$id)}return UsersManager.findCerclesByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid).then(function(cercles){return cercles.length>0?LiensService.findLinksByCerlceName(cercles[0].$id):[]})}],allMyCercles:["UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",function(UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){return UsersManager.findCerclesByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],allCategories:["LiensService",function(LiensService){return LiensService.findCategories()}]}}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function($translate,$translatePartialLoader){return $translatePartialLoader.addPart("commons"),$translatePartialLoader.addPart("el1-view"),$translate.refresh()}],currentAuth:["FBFactory",function(FBFactory){return FBFactory.auth().$requireAuth()}]}})})}(angular.module("el1.cercle",["ngMaterial","ui.router","el1.services.commun","el1.model"])),function(){function CercleController($log,$scope,$cookieStore,commonsService,LiensService,liens,allCategories,allMyCercles,SessionStorage,USERFIREBASEPROFILEKEY,$mdToast){$scope.allLiens=liens,$scope.categories=allCategories,$scope.cercles=allMyCercles,$scope.filter={category:""},$scope.isLikeDisabled=!1,$cookieStore.get("selectedCategory")?$scope.filter.category=$cookieStore.get("selectedCategory"):$scope.filter.category="",$cookieStore.get("selectedCercle")?$scope.selectedCercle=$cookieStore.get("selectedCercle"):allMyCercles[0]&&($scope.selectedCercle=allMyCercles[0]),$scope.changeCategory=function(category){$log.info("change "+category),$scope.filter.category=category,$cookieStore.put("selectedCategory",category)},$scope.changeCercle=function(cercle){$scope.selectedCercle=cercle,LiensService.findLinksByCerlceName(cercle.$id).then(function(links){$scope.allLiens=links}),$cookieStore.put("selectedCercle",cercle)},$scope.showURL=function(lien){window.open(lien.url,"_blank")},$scope.moveToBiblio=function(lien){lien["private"]="biblio",LiensService.createLinkForUser(lien,SessionStorage.get(USERFIREBASEPROFILEKEY).uid),commonsService.showSuccessToast($mdToast,"Le lien a été ajouté à votre biblio")},$scope.like=function(lien){LiensService.addLike($scope.selectedCercle.$id,lien.$id),commonsService.showSuccessToast($mdToast,"'Like' pris en compte")}}angular.module("el1.cercle").controller("cercleController",["$log","$scope","$cookieStore","commonsService","LiensService","liens","allCategories","allMyCercles","SessionStorage","USERFIREBASEPROFILEKEY","$mdToast",CercleController])}(),$(window).load(function(){$("img[data-url]").each(function(){$.ajax({url:"https://www.googleapis.com/pagespeedonline/v1/runPagespeed?url="+$(this).data("url")+"&screenshot=true",context:this,type:"GET",dataType:"json",success:function(data){data=data.screenshot.data.replace(/_/g,"/").replace(/-/g,"+"),$(this).attr("src","data:image/jpeg;base64,"+data)}})})}),angular.module("el1.error",["ui.router"]).config(function($stateProvider){$stateProvider.state("pageErreur",{url:"/erreurs",views:{main:{controller:"ErrorController",templateUrl:"src/app/error/error.tpl.html"}}})}).controller("ErrorController",function($rootScope,$scope,$http,$location,AuthService){}),function(module){"use strict";module.config(function($stateProvider){$stateProvider.state("gestion-view",{url:"/gestion/view",data:{title:"gestion"},views:{main:{controller:"gestionController",templateUrl:"src/app/gestionCercles/views/el1-gestion.tpl.html",resolve:{personnesDuCercle:["GestionService","UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",function(GestionService,UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){return UsersManager.findCerclesByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid).then(function(cerclesIndex){return cerclesIndex&&cerclesIndex.length>0?GestionService.findPersonnesByCercle(cerclesIndex[0]):[]})}],mesInvitations:["UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",function(UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){return UsersManager.findInvitationsByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],mesCercles:["UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",function(UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){return UsersManager.findCerclesByUser(SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}],usersEmail:["UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",function(UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){return UsersManager.getUsersEmail(SessionStorage.get(USERFIREBASEPROFILEKEY).uid).then(function(users){return users})}]}}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function($translate,$translatePartialLoader){return $translatePartialLoader.addPart("commons"),$translatePartialLoader.addPart("el1-gestion"),$translate.refresh()}],currentAuth:["FBFactory",function(FBFactory){return FBFactory.auth().$requireAuth()}]}})})}(angular.module("el1.gestion",["ngMaterial","ui.router","el1.services.commun","el1.model"])),function(){function GestionController($log,$scope,$cookieStore,$q,$timeout,$translate,GestionService,UsersManager,commonsService,mesInvitations,personnesDuCercle,mesCercles,usersEmail,SessionStorage,USERFIREBASEPROFILEKEY,$mdDialog,$mdMedia,$mdToast){function querySearch(query){var deferred,results=query?$scope.users.filter(createFilterFor(query)):$scope.users;return deferred=$q.defer(),$timeout(function(){deferred.resolve(results)},1e3*Math.random(),!1),deferred.promise}function createFilterFor(query){var lowercaseQuery=angular.lowercase(query);return function(user){return 0===user.email.indexOf(lowercaseQuery)}}function searchTextChange(text){$log.info("Text changed to "+text)}function selectedItemChange(user){$log.info("Item changed to "+JSON.stringify(user))}$scope.mesInvitations=mesInvitations,$scope.personnes=personnesDuCercle,$scope.cercles=mesCercles,$scope.users=usersEmail,$scope.selectedItemChange=selectedItemChange,$scope.searchTextChange=searchTextChange,$scope.querySearch=querySearch,$scope.selectedItem=null,$scope.invited=[],$scope.invitedDisplay="",$cookieStore.get("selectedCercle")?($log.info("gestion cercle "+$cookieStore.get("selectedCercle")+$cookieStore.get("selectedCercle").$id),$scope.selectedCercle=$cookieStore.get("selectedCercle")):mesCercles[0]&&($scope.selectedCercle=mesCercles[0]),$scope.nouveauCercle=function(ev){$mdDialog.show({controller:NouveauCercleController,templateUrl:"src/app/gestionCercles/views/el1-nouveauCercle.tpl.html",parent:angular.element(document.body),targetEvent:ev,locals:{},clickOutsideToClose:!0,fullscreen:$mdMedia("sm")&&$scope.customFullscreen}).then(function(buttonNumber){},function(){}),$scope.$watch(function(){return $mdMedia("sm")},function(sm){$scope.customFullscreen=sm===!0})},$scope.changeCercle=function(cercleSelected){GestionService.findPersonnesByCercle(cercleSelected).then(function(personnes){$scope.selectedCercle=cercleSelected,$scope.personnes=personnes})["catch"](function(error){$log.error(error)}),$cookieStore.put("selectedCercle",cercleSelected)},$scope.inviter=function(invite){null!==invite&&UsersManager.inviter(invite.uid,$scope.selectedCercle.$id).then(function(username){$scope.invited.push(invite.email),$scope.invitedDisplay=$scope.invited.join(", "),$scope.selectedItem=null,$scope.searchText=null,$log.info($translate.instant("gestion.message.inviter"))})["catch"](function(error){$log.error(error)})},$scope.accepterInvitation=function(invitation){GestionService.accepterInvitation(SessionStorage.get(USERFIREBASEPROFILEKEY).uid,invitation.$id).then(function(cerclename){$log.info($translate.instant("gestion.message.accepterInvitation")),commonsService.showSuccessToast($mdToast,$translate.instant("gestion.message.accepterInvitation"))})["catch"](function(error){$log.error(error)})}}function NouveauCercleController($log,$scope,GestionService,CercleModel,$mdDialog,$mdMedia){$scope.currentCercle=new CercleModel,$scope.alerts=[],$scope.hide=function(){$mdDialog.hide()},$scope.cancel=function(){$mdDialog.cancel()},$scope.validate=function(currentCercle){$scope.currentForm.$valid&&GestionService.createCercle(currentCercle).then(function(cerclename){$mdDialog.hide("0")},function(error){$log.error(error)})},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)}}angular.module("el1.gestion").controller("gestionController",["$log","$scope","$cookieStore","$q","$timeout","$translate","GestionService","UsersManager","commonsService","mesInvitations","personnesDuCercle","mesCercles","usersEmail","SessionStorage","USERFIREBASEPROFILEKEY","$mdDialog","$mdMedia","$mdToast",GestionController]).controller("nouveauCercleController",["$log","$scope","GestionService","CercleModel","$mdDialog","$mdMedia",NouveauCercleController])}(),function(module){"use strict";module.config(function($stateProvider){$stateProvider.state("icdc-view",{url:"/icdc/view",data:{title:"ICDC"},views:{main:{controller:"icdcController",templateUrl:"src/app/icdc/views/el1-view.tpl.html",resolve:{allCategories:["LiensService",function(LiensService){return LiensService.findCategories()}],topTen:["LiensService",function(LiensService){return LiensService.findTopTenLinks()}]}}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function($translate,$translatePartialLoader){return $translatePartialLoader.addPart("commons"),$translatePartialLoader.addPart("el1-view"),$translate.refresh()}],currentAuth:["FBFactory",function(FBFactory){return FBFactory.auth().$requireAuth()}]}})})}(angular.module("el1.icdc",["ngMaterial","ui.router","el1.services.commun","el1.model"])),function(){function ICDCController($log,$scope,$cookieStore,$mdToast,commonsService,LiensService,allCategories,topTen,SessionStorage,USERFIREBASEPROFILEKEY){$scope.topTen=topTen,$scope.categories=allCategories,$scope.filter={category:""},$cookieStore.get("selectedCategory")?$scope.filter.category=$cookieStore.get("selectedCategory"):$scope.filter.category="",$scope.showURL=function(lien){window.open(lien.url,"_blank")},$scope.changeCategory=function(category){$scope.filter.category=category,$cookieStore.put("selectedCategory",category)},$scope.moveToBiblio=function(lien){lien["private"]="biblio",LiensService.createLinkForUser(lien,SessionStorage.get(USERFIREBASEPROFILEKEY).uid),commonsService.showSuccessToast($mdToast,"Le lien a été ajouté à votre biblio")}}angular.module("el1.icdc").controller("icdcController",["$log","$scope","$cookieStore","$mdToast","commonsService","LiensService","allCategories","topTen","SessionStorage","USERFIREBASEPROFILEKEY",ICDCController])}(),angular.module("el1.login",["el1.services.commun","el1.model","ngCookies"]).config(function($stateProvider){$stateProvider.state("showLogin",{url:"/showLogin",data:{pageTitle:"Login"},views:{main:{controller:"LoginCtrl",templateUrl:"src/app/login/login.tpl.html"}},resolve:{translatePartialLoader:["$translate","$translatePartialLoader",function($translate,$translatePartialLoader){return $translatePartialLoader.addPart("commons"),$translatePartialLoader.addPart("login"),$translate.refresh()}]}})}).controller("LoginCtrl",function($q,$state,$rootScope,$scope,$log,FBURL,$cookieStore,$firebaseAuth,GOOGLEAUTHSCOPE,UsersManager){var ref=new Firebase(FBURL),auth=$firebaseAuth(ref);$scope.login=function(){auth.$authWithOAuthPopup("google",{remember:"sessionOnly",scope:GOOGLEAUTHSCOPE}).then(function(authData){return $q.when(authData)}).then(function(authData){return UsersManager.addUser(authData)}).then(function(userConnected){return UsersManager.addUserEmail(userConnected)}).then(function(userConnected){return $rootScope.userAuthenticated=!0,$cookieStore.put("user",userConnected),$rootScope.userEmail=userConnected.email,$q.when(userConnected)}).then(function(userConnected){$state.go("home")})["catch"](function(error){$log.info("Authentication failed:",error)})}}),angular.module("elinkApp").directive("cdcAlertError",function(AlertService,$rootScope,$translate){return{restrict:"E",template:'<div ng-repeat="alert in alerts" class="alert" ng-class="[\'alert-\' + (alert.type || \'warning\'), alert.closeable ? \'alert-dismissible\' : null]" role="alert"><div layout="row"><div>{{ alert.msg }}</div><button ng-show="alert.closeable" type="button" class="close" ng-click="alert.close({$event: $event})"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div></div>',controller:["$scope",function($scope){$scope.alerts=AlertService.get();var cleanHttpErrorListener=$rootScope.$on("httpError",function(event,httpResponse){var i;switch(event.stopPropagation(),httpResponse.status){case-1:addErrorAlert("Server not reachable","error.serverNotReachable");break;case 0:addErrorAlert("Server not reachable","error.serverNotReachable");break;case 400:if(httpResponse.data&&httpResponse.data.fieldErrors)for(i=0;i<httpResponse.data.fieldErrors.length;i++){var fieldError=httpResponse.data.fieldErrors[i],fieldName=fieldError.fieldname;addErrorAlert(fieldName+":"+fieldError.message)}else httpResponse.data&&httpResponse.data.message?addErrorAlert(httpResponse.data.message,httpResponse.data.message,httpResponse.data):addErrorAlert(httpResponse.data);break;default:addErrorAlert(httpResponse.data&&httpResponse.data.message?httpResponse.data.message:JSON.stringify(httpResponse))}});$scope.$on("$destroy",function(){void 0!==cleanHttpErrorListener&&null!==cleanHttpErrorListener&&cleanHttpErrorListener()});var addErrorAlert=function(message,key,data){key=key&&null!=key?key:message,AlertService.error(key,data)}}]}}),angular.module("elinkApp").factory("AlertService",function($timeout,$sce,$translate){function clear(){alerts=[]}function get(){return alerts}function success(msg,params){this.add({type:"success",msg:msg,params:params,timeout:timeout,closeable:!0})}function error(msg,params){this.add({type:"danger",msg:msg,params:params,timeout:timeout,closeable:!0})}function warning(msg,params){this.add({type:"warning",msg:msg,params:params,timeout:timeout,closeable:!0})}function info(msg,params){this.add({type:"info",msg:msg,params:params,timeout:timeout,closeable:!0})}function factory(alertOptions){return alerts.push({type:alertOptions.type,msg:$sce.trustAsHtml(alertOptions.msg),id:alertOptions.alertId,timeout:alertOptions.timeout,closeable:!0,close:function(){return exports.closeAlert(this.id)}})}function addAlert(alertOptions){alertOptions.alertId=alertId++,alertOptions.msg=$translate.instant(alertOptions.msg,alertOptions.params);var that=this;this.factory(alertOptions),alertOptions.timeout&&alertOptions.timeout>0&&$timeout(function(){that.closeAlert(alertOptions.alertId)},alertOptions.timeout)}function closeAlert(id){return this.closeAlertByIndex(alerts.map(function(e){return e.id}).indexOf(id))}function closeAlertByIndex(index){return alerts.splice(index,1)}var exports={factory:factory,add:addAlert,closeAlert:closeAlert,closeAlertByIndex:closeAlertByIndex,clear:clear,get:get,success:success,error:error,info:info,warning:warning},alertId=0,alerts=[],timeout=3e4;return exports}),angular.module("elinkApp").directive("hasRole",["Env","AuthService",function(Env,AuthService){return{restrict:"A",link:function(scope,element,attrs){var setVisible=function(){element.removeClass("hidden")},setHidden=function(){element.addClass("hidden")},defineVisibility=function(role){Env.getUser()&&AuthService.isInRole(role)?setVisible():setHidden()},role=attrs.hasRole.replace(/\s+/g,"");scope.$watch("user",function(newValue,oldValue){role.length>0&&defineVisibility(role)})}}}]),angular.module("elinkApp").directive("pict",function($rootScope){return{restrict:"E",template:'<div flex="15"><img src="{{ imgsrc }}" data-url="{{ lien.url }}" style="width:450%" ></div>',controller:["$scope","LiensService",function($scope,LiensService){LiensService.findLinkScreen($scope.lien).then(function(payload){if(payload)$scope.imgsrc="data:image/jpeg;base64,"+payload;else var unregister=$scope.$watch(function(){var anId=$scope.lien.$id;return $rootScope.images[anId]},function(){var anId=$scope.lien.$id,linkScreen=$rootScope.images[anId];linkScreen&&linkScreen.$value&&($scope.imgsrc="data:image/jpeg;base64,"+linkScreen.$value,unregister())})},function(error){})}]}}),angular.module("elinkApp").factory("authExpiredInterceptor",function($rootScope,$q,$injector){return{responseError:function(response){if(401==response.status&&void 0!==response.data.path&&-1==response.data.path.indexOf("login")){var $state=$injector.get("$state"),to=$rootScope.toState,params=$rootScope.toStateParams;$rootScope.authenticated=!1,$rootScope.returnToState=to,$rootScope.returnToStateParams=params,$state.go("showLogin")}return $q.reject(response)}}}),angular.module("elinkApp").factory("errorHandlerInterceptor",function($q,$rootScope){return{responseError:function(response){return(401!=response.status||0!=response.data.path.indexOf("/login"))&&$rootScope.$emit("httpError",response),$q.reject(response)}}}),angular.module("el1.model").factory("CercleModel",function(){function CercleModel(data){angular.copy(data,this),this.toString=function(){return" "+this.label+" "}}return CercleModel}).factory("CerclesModel",["CercleModel",function(CercleModel){function CerclesModel(data){this.items=new Array(data.length);for(var i in data)this.items[i]=new CercleModel(data[i])}return CerclesModel}]),angular.module("el1.model").factory("Env",function(){var _backend,_user,_backendfirebase;return{init:function(data){_backend=data.backend,_backendfirebase=data.backendfirebase},backend:function(){return _backend},backendfirebase:function(){return _backendfirebase},setUser:function(user){_user=user},getUser:function(){return _user},isAuthenticated:function(){return null!==_user},isAdmin:function(){return null!==_user&&_user.admin},isMock:function(){return!1}}}),angular.module("el1.model").factory("LienModel",function(){function LienModel(data){angular.copy(data,this),this.toString=function(){return" "+this.lu+" "+this["private"]+" "+this.url+" "}}return LienModel}).factory("LiensModel",["LienModel",function(LienModel){function LiensModel(data){this.items=new Array(data.length);for(var i in data)this.items[i]=new LienModel(data[i])}return LiensModel}]),angular.module("el1.model").factory("PersonneModel",function(){function PersonneModel(data){angular.copy(data,this),this.toString=function(){return" "+this.email+" "+this.nom+" "+this.prenom+" "}}return PersonneModel}).factory("PersonnesModel",["PersonneModel",function(PersonneModel){function PersonnesModel(data){this.items=new Array(data.length);for(var i in data)this.items[i]=new PersonneModel(data[i])}return PersonnesModel}]),angular.module("el1.model").factory("UserModel",function(){function UserModel(data){angular.copy(data,this)}return UserModel}),function(){"use strict";function AuthService(FBURL){return{logout:function(){var ref=new Firebase(FBURL);ref.unauth()}}}angular.module("el1.services.commun").service("AuthService",["FBURL",AuthService])}(),function(){"use strict";function EscapeUtils(){this.escapeEmail=function(email){return(email||"").replace(".",",")},this.unescapeEmail=function(email){return(email||"").replace(",",".")}}function CommonsService($q,$http){return{flatModel:function(aModel){var result="",index=0;for(var prop in aModel)"function"!=typeof aModel[prop]&&"object"!=typeof aModel[prop]&&void 0!=aModel[prop]&&(0!=index&&(result+="|"),result=result+prop+"::"+aModel[prop],index+=1);return result},showSuccessToast:function($mdToast,message){$mdToast.show($mdToast.simple().textContent(message).position("bottom right").hideDelay(3e3))}}}function FBFactory($firebaseAuth,$firebaseArray,FBURL){return{auth:function(){var FBRef=new Firebase(FBURL);return $firebaseAuth(FBRef)}}}function LocalStorage(){return{set:function(key,value){return localStorage.setItem(key,JSON.stringify(value))},get:function(key){return JSON.parse(localStorage.getItem(key))},remove:function(key){return localStorage.removeItem(key)}}}function SessionStorage(){return{set:function(key,value){return sessionStorage.setItem(key,JSON.stringify(value))},get:function(key){return JSON.parse(sessionStorage.getItem(key))},remove:function(key){return sessionStorage.removeItem(key)}}}angular.module("el1.services.commun").service("commonsService",["$q","$http",CommonsService]).service("EscapeUtils",EscapeUtils).factory("FBFactory",["$firebaseAuth","$firebaseArray","FBURL",FBFactory]).factory("LocalStorage",[LocalStorage]).factory("SessionStorage",[SessionStorage]);
}(),Date.prototype.formatDate=function(format){var date=this,day=date.getDate(),month=date.getMonth()+1,year=date.getFullYear(),hours=date.getHours(),minutes=date.getMinutes(),seconds=date.getSeconds();return format||(format="MM/dd/yyyy"),format=format.replace("MM",month.toString().replace(/^(\d)$/,"0$1")),format.indexOf("yyyy")>-1?format=format.replace("yyyy",year.toString()):format.indexOf("yy")>-1&&(format=format.replace("yy",year.toString().substr(2,2))),format=format.replace("dd",day.toString().replace(/^(\d)$/,"0$1")),format.indexOf("t")>-1&&(format=hours>11?format.replace("t","pm"):format.replace("t","am")),format.indexOf("HH")>-1&&(format=format.replace("HH",hours.toString().replace(/^(\d)$/,"0$1"))),format.indexOf("hh")>-1&&(hours>12&&(hours-=12),0===hours&&(hours=12),format=format.replace("hh",hours.toString().replace(/^(\d)$/,"0$1"))),format.indexOf("mm")>-1&&(format=format.replace("mm",minutes.toString().replace(/^(\d)$/,"0$1"))),format.indexOf("ss")>-1&&(format=format.replace("ss",seconds.toString().replace(/^(\d)$/,"0$1"))),format},function(){"use strict";function GestionService($q,$firebaseObject,$firebaseArray,PersonnesModel,FBURL,UsersManager,SessionStorage,USERFIREBASEPROFILEKEY){function saveCercle(cercleName,cercleDescription,username){var deferred=$q.defer(),cercleRef=ref.child("cercles").child(cercleName),cercle=$firebaseObject(cercleRef);return cercle.$loaded().then(function(){null!==cercle.$value?deferred.reject(new Error("le cercle existe d�j� !")):(cercle.user=username,cercle.created=Firebase.ServerValue.TIMESTAMP,cercle.description=cercleDescription,cercle.$save().then(function(){deferred.resolve(cercle)})["catch"](function(error){deferred.reject(error)}))})["catch"](function(error){deferred.reject(error)}),deferred.promise}function saveCercleMember(cerclename,username){var deferred=$q.defer(),cercleMemberRef=ref.child("cercleMembers").child(cerclename).child(username),cercleMember=$firebaseObject(cercleMemberRef);return cercleMember.$loaded().then(function(){cercleMember.$value=!0,cercleMember.$save().then(function(){deferred.resolve(cerclename)})["catch"](function(error){deferred.reject(error)})})["catch"](function(error){deferred.reject(error)}),deferred.promise}function getCercleUsers(usersIndex){var promises=[];return angular.forEach(usersIndex,function(userIndex,index){promises.push(UsersManager.getUser(userIndex.$id))}),$q.all(promises)}var ref=new Firebase(FBURL);return{createCercle:function(aCercleModel){return saveCercle(aCercleModel.label,aCercleModel.description,SessionStorage.get(USERFIREBASEPROFILEKEY).uid).then(function(cercle){return saveCercleMember(cercle.$id,SessionStorage.get(USERFIREBASEPROFILEKEY).uid)}).then(function(cerclename){return UsersManager.addCercle(SessionStorage.get(USERFIREBASEPROFILEKEY).uid,cerclename)})},accepterInvitation:function(username,cerclename){return saveCercleMember(cerclename,username).then(function(cercleName){return UsersManager.addCercle(username,cerclename)}).then(function(user){return UsersManager.removeInvitation(username,cerclename)})},findPersonnesByCercle:function(cercle){var deferred=$q.defer(),membersRef=ref.child("cercleMembers").child(cercle.$id),membersIndex=$firebaseArray(membersRef);return membersIndex.$loaded().then(function(){return getCercleUsers(membersIndex)}).then(function(users){deferred.resolve(users)})["catch"](function(error){deferred.reject(error)}),deferred.promise},shareLien:function(shareLink,userConnected){var deferred=$q.defer(),cercleLinksRef=ref.child("cercleLinks").child(shareLink.cercleName),cercleLinksIndex=$firebaseArray(cercleLinksRef);return cercleLinksIndex.$loaded().then(function(){var newCercle={title:shareLink.title,teasing:shareLink.teasing,createdOn:Firebase.ServerValue.TIMESTAMP,url:shareLink.url,category:shareLink.category,sharedBy:userConnected.google.cachedUserProfile.name,keyOri:shareLink.keyOri};cercleLinksIndex.$add(newCercle).then(function(){deferred.resolve(newCercle)})})["catch"](function(error){deferred.reject(error)}),deferred.promise}}}angular.module("el1.services.commun").service("GestionService",["$q","$firebaseObject","$firebaseArray","PersonnesModel","FBURL","UsersManager","SessionStorage","USERFIREBASEPROFILEKEY",GestionService])}(),function(){"use strict";function LiensService($log,$q,$http,FBURL,$firebaseArray,$firebaseObject,Env){var ref=new Firebase(FBURL);return{findLinkScreen:function(lien){var deferred=$q.defer(),screenKey=lien.$id;lien.keyOri&&(screenKey=lien.keyOri);var linkScreens=ref.child("linkScreens").child(screenKey);return linkScreens.once("value",function(snap){var payload=snap.val();null!=payload?deferred.resolve(payload):($log.info("image introuvable"),deferred.resolve(void 0))}),deferred.promise},screenshotAndStore:function(lien){var deferred=$q.defer(),_that=this,config={};return config.headers=config.headers||{},config.headers.Accept="application/json",$http.get("https://www.googleapis.com/pagespeedonline/v1/runPagespeed?url="+lien.url+"&screenshot=true",config).then(function(response){var data=response.data;_that.addLinkScreen(lien.$id,data).then(function(linkScreen){deferred.resolve(linkScreen)})["catch"](function(error){deferred.reject(error)})},function(error){deferred.reject(error)}),deferred.promise},addLinkScreen:function(linkId,dataScreen){var deferred=$q.defer(),linkScreenRef=ref.child("linkScreens").child(linkId),linkScreen=$firebaseObject(linkScreenRef);return linkScreen.$loaded().then(function(){linkScreen.$value=dataScreen.screenshot.data.replace(/_/g,"/").replace(/-/g,"+"),linkScreen.$save(),deferred.resolve(linkScreen)})["catch"](function(error){deferred.reject(error)}),deferred.promise},createLinkForUser:function(lien,username){var userLinksRef,deferred=$q.defer();userLinksRef="biblio"===lien["private"]?ref.child("usersLinks").child(username).child("read"):ref.child("usersLinks").child(username).child("notread");var userLinks=$firebaseArray(userLinksRef);return userLinks.$loaded().then(function(){var newLink={};newLink.createdOn=Firebase.ServerValue.TIMESTAMP,newLink.title=lien.title?lien.title:lien.url.substring(0,100),newLink.url=lien.url,newLink.teasing="",userLinks.$add(newLink).then(function(linkAdded){newLink.$id=linkAdded.key(),deferred.resolve(newLink)})})["catch"](function(error){deferred.reject(error)}),deferred.promise},findNotReadLinksByUser:function(username){var deferred=$q.defer(),userLinksNotReadRef=ref.child("usersLinks").child(username).child("notread"),userLinksNotRead=$firebaseArray(userLinksNotReadRef);return userLinksNotRead.$loaded().then(function(){deferred.resolve(userLinksNotRead)})["catch"](function(error){deferred.reject(error)}),deferred.promise},findReadLinksByUser:function(username){var deferred=$q.defer(),userLinksReadRef=ref.child("usersLinks").child(username).child("read"),userLinksRead=$firebaseArray(userLinksReadRef);return userLinksRead.$loaded().then(function(){deferred.resolve(userLinksRead)})["catch"](function(error){deferred.reject(error)}),deferred.promise},findLinksByCerlceName:function(cercleName){var deferred=$q.defer(),cercleLinksRef=ref.child("cercleLinks").child(cercleName),cercleLinks=$firebaseArray(cercleLinksRef);return cercleLinks.$loaded().then(function(){deferred.resolve(cercleLinks)})["catch"](function(error){deferred.reject(error)}),deferred.promise},findLinksByCerlceNameAndIdLink:function(cercleName,idLink){var deferred=$q.defer(),cercleLinkRef=ref.child("cercleLinks").child(cercleName).child(idLink),cercleLink=$firebaseObject(cercleLinkRef);return cercleLink.$loaded().then(function(){deferred.resolve(cercleLink)})["catch"](function(error){deferred.reject(error)}),deferred.promise},addLike:function(cercleName,idLink){var deferred=$q.defer(),cercleLinkLikeRef=ref.child("cercleLinksLike").child(cercleName+idLink),cercleLinkLike=$firebaseObject(cercleLinkLikeRef);return cercleLinkLike.$loaded().then(function(){cercleLinkLike.$value=null===cercleLinkLike.$value?1:cercleLinkLike.$value+1,cercleLinkLike.$save(),deferred.resolve(cercleLinkLike)})["catch"](function(error){deferred.reject(error)}),deferred.promise},findTopTenLinks:function(){var deferred=$q.defer(),_that=this,likeRef=new Firebase(FBURL+"cercleLinksLike");return likeRef.orderByValue().limitToLast(10).on("value",function(snapshot){var topTen=[];snapshot.forEach(function(data){var key=data.key(),keyValue=key.split("-"),cptLike=data.val();_that.findLinksByCerlceNameAndIdLink(keyValue[0],"-"+keyValue[1]).then(function(aLink){topTen.push(angular.extend({},{link:aLink,cpt:cptLike,cercleName:keyValue[0]}))})}),deferred.resolve(topTen)}),deferred.promise},findCategories:function(){var deferred=$q.defer(),ref=new Firebase(Env.backendfirebase()+"categories"),categories=$firebaseArray(ref);return categories.$loaded().then(function(){var array=[];categories.forEach(function(obj){array.push(obj.$value)}),deferred.resolve(array)})["catch"](function(error){deferred.reject(error)}),deferred.promise},findMyCercles:function(){var deferred=$q.defer(),ref=new Firebase(Env.backendfirebase()+"cercles"),cercles=$firebaseArray(ref);return cercles.$loaded().then(function(){var array=[];cercles.forEach(function(obj){array.push(obj.$id)}),deferred.resolve(array)})["catch"](function(error){deferred.reject(error)}),deferred.promise}}}angular.module("el1.services.commun").service("LiensService",["$log","$q","$http","FBURL","$firebaseArray","$firebaseObject","Env",LiensService])}(),function(){"use strict";function UsersManager($firebaseObject,$firebaseArray,$q,FBURL,EscapeUtils){var ref=new Firebase(FBURL);return{addUser:function(authData){var deferred=$q.defer(),userRef=ref.child("users").child(authData.uid),user=$firebaseObject(userRef);return user.$loaded().then(function(){user.email?deferred.resolve(user):(user.uid=authData.uid,user.email=authData.google.cachedUserProfile.email,user.fullname=authData.google.cachedUserProfile.name,user.firstname=authData.google.cachedUserProfile.given_name,user.lastname=authData.google.cachedUserProfile.family_name,user.picture=authData.google.cachedUserProfile.picture,user.$save().then(function(){deferred.resolve(user)}))})["catch"](function(error){deferred.reject(error)}),deferred.promise},addUserEmail:function(userEmail){var deferred=$q.defer(),userEmailRef=ref.child("usersEmail").child(EscapeUtils.escapeEmail(userEmail.email)),userEmail=$firebaseObject(userEmailRef);return userEmail.$loaded().then(function(){userEmail.$value?deferred.resolve(userEmail):(userEmail.$value=userEmail.$id,userEmail.$save().then(function(){deferred.resolve(userEmail)}))})["catch"](function(error){deferred.reject(error)}),deferred.promise},getUsersEmail:function(idUserConnected){var deferred=$q.defer(),usersEmailRef=ref.child("usersEmail"),usersEmail=$firebaseArray(usersEmailRef);return usersEmail.$loaded().then(function(){var users=[];usersEmail.length>0&&usersEmail.forEach(function(user){user.$value!==idUserConnected&&users.push({uid:user.$value,email:EscapeUtils.unescapeEmail(user.$id)})}),deferred.resolve(users)})["catch"](function(error){deferred.reject(error)}),deferred.promise},getUser:function(username){var userRef=ref.child("users").child(username),user=$firebaseObject(userRef);return user.$loaded()},getUserFullname:function(userIndex){var deferred=$q.defer(),userRef=ref.child("users").child(userIndex.$id).child("fullname"),user=$firebaseObject(userRef);return user.$loaded().then(function(){deferred.resolve(user.$value)})["catch"](function(error){deferred.reject(error)}),deferred.promise},removeCercle:function(username,cercleName){var deferred=$q.defer(),userCercleMemberRef=ref.child("users").child(username).child("cercles").child(cercleName),user=$firebaseObject(userCercleMemberRef);return user.$remove().then(function(){deferred.resolve("OK")})["catch"](function(error){deferred.reject(error)}),deferred.promise},addCercle:function(username,cerclename){var deferred=$q.defer(),userCercleMemberRef=ref.child("users").child(username).child("cercles").child(cerclename),userCercles=$firebaseObject(userCercleMemberRef);return userCercles.$loaded().then(function(){userCercles.$value=!0,userCercles.$save().then(function(){deferred.resolve(cerclename)})})["catch"](function(error){deferred.reject(error)}),deferred.promise},findCerclesByUser:function(username){var deferred=$q.defer(),userCerclesRef=ref.child("users").child(username).child("cercles"),userCercles=$firebaseArray(userCerclesRef);return userCercles.$loaded().then(function(){deferred.resolve(userCercles)})["catch"](function(error){deferred.reject(error)}),deferred.promise},findInvitationsByUser:function(username){var deferred=$q.defer(),usersInvitationRef=ref.child("usersInvitation").child(username),userInvitations=$firebaseArray(usersInvitationRef);return userInvitations.$loaded().then(function(){deferred.resolve(userInvitations)})["catch"](function(error){deferred.reject(error)}),deferred.promise},inviter:function(username,cerclename){var deferred=$q.defer(),usersInvitationRef=ref.child("usersInvitation").child(username).child(cerclename),userInvitation=$firebaseObject(usersInvitationRef);return userInvitation.$loaded().then(function(){userInvitation.$value=!0,userInvitation.$save().then(function(){deferred.resolve(username)})})["catch"](function(error){deferred.reject(error)}),deferred.promise},removeInvitation:function(username,cerclename){var deferred=$q.defer(),usersInvitationRef=ref.child("usersInvitation").child(username).child(cerclename),userInvitation=$firebaseObject(usersInvitationRef);return userInvitation.$loaded().then(function(){userInvitation.$remove().then(function(){deferred.resolve(username)})})["catch"](function(error){deferred.reject(error)}),deferred.promise}}}angular.module("el1.services.commun").service("UsersManager",["$firebaseObject","$firebaseArray","$q","FBURL","EscapeUtils",UsersManager])}();